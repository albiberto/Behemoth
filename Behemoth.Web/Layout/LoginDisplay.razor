@using Microsoft.AspNetCore.Components.WebAssembly.Authentication
@inject NavigationManager Navigation

<AuthorizeView>
    <Authorized>
        <MudMenu Icon="@Icons.Material.Filled.Person" Color="Color.Inherit" Direction="Direction.Bottom" OffsetY="true">
            <ActivatorContent>
                <MudButton Variant="Variant.Text" Color="Color.Inherit" EndIcon="@Icons.Material.Filled.ArrowDropDown">
                    Ciao, @(context.User.Identity?.Name ?? "Utente")
                </MudButton>
            </ActivatorContent>
            <ChildContent>
                <MudMenuItem Href="/profile" Icon="@Icons.Material.Outlined.AccountCircle">Profilo</MudMenuItem>
                <MudMenuItem Icon="@Icons.Material.Outlined.Logout" OnClick="BeginLogOut">Log out</MudMenuItem>
            </ChildContent>
        </MudMenu>
    </Authorized>

    <NotAuthorized>
        <MudButton Href="authentication/login" Variant="Variant.Text" Color="Color.Inherit"
                   StartIcon="@Icons.Material.Filled.Login">
            Log in
        </MudButton>
    </NotAuthorized>
</AuthorizeView>

@code {
    public void BeginLogOut() => Navigation.NavigateToLogout("authentication/logout");
}